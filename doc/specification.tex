\documentclass[a4paper]{book}

\usepackage{mathptmx}
\usepackage{helvet}
\usepackage{courier}
\usepackage{type1cm}
\usepackage{graphicx}
\usepackage{multicol}
\usepackage[bottom]{footmisc}
\usepackage[hyphens]{url}
\usepackage[pdftex]{hyperref}
\usepackage{color}
\usepackage{soul}
\usepackage[caption=false,font=footnotesize]{subfig}
\usepackage{amsmath}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage{cite}
\usepackage{enumitem}
\usepackage{comment}
\usepackage{listings}
\lstset{frame=tb,basicstyle={\footnotesize\ttfamily}}

\begin{document}

\title{\textbf{A Security Benchmark Suite Exploring the Existing Vulnerabilities of a Computer System} \\ \large{Version: 0.1.0}}

\author{Jiameng Ying, Boya Li, Sihao Shen, and Wei Song$^*$\\
\small{Institute of Information Engineeringat at the Chinese Academy of Sciences}\\
\small{89 Minzhuang Road, Haidian, Beijing 100093, P. R. China}\\
\small{$^*$\url{songwei@iie.ac.cn}}}

\maketitle

\copyright 2017-2019, Institute of Information Engineering, CAS, all rights reserved.

\section*{Contributors}

\begin{description}
\item[Boya Li]
  (11.2017 -- 01.2019, IIE-CAS)
  Participated in the initial vulnerability analyses.
  Provided the initial test cases for the buffer over/underflow write tests.
  Provided the initial ideas for testing use-after-free vulnerabilities.
\item[Sihao Shen]
  (02.2019 -- 09.2019, IIE-CAS)
  Added documentation of BOF and CFI.
  Added the initial support for the RISC-V RV64G ISA.
\item[Wei Song]
  (11.2017 -- 09.2019, IIE-CAS)
  The organizer of the project. 
\item[Jiameng Yin]
  (11.2017 -- 01.2019, IIE-CAS)
  Participated in the initial vulnerability analyses.
  Provided the initial test cases for numerous CFI and CPI tests.
\item[Yuhui Zhang]
  (11.2017 -- 04.2018, IIE-CAS)
  Participated in the initial vulnerability analyses.
\end{description}

\tableofcontents
\newpage

\chapter{Introduction}

\chapter{Overview of the Security Benchmark Suite}

\chapter{Description of Test Cases}

\section{Buffer Overflow (BOF)}
\begin{itemize}[noitemsep]

\item Overflow read
 \begin{itemize}[noitemsep, nolistsep, leftmargin=1em]
    \item[\ref{test-overflow-read-index-rodata}]      \texttt{overflow-read-index-rodata}
    \item[\ref{test-overflow-read-index-data}]        \texttt{overflow-read-index-data}
    \item[\ref{test-overflow-read-index-heap}]        \texttt{overflow-read-index-heap}
    \item[\ref{test-overflow-read-index-stack}]       \texttt{overflow-read-index-stack}
    \item[\ref{test-overflow-read-ptr-rodata}]        \texttt{overflow-read-ptr-rodata}
    \item[\ref{test-overflow-read-ptr-data}]          \texttt{overflow-read-ptr-data}
    \item[\ref{test-overflow-read-ptr-heap}]          \texttt{overflow-read-ptr-heap}
    \item[\ref{test-overflow-read-ptr-stack}]         \texttt{overflow-read-ptr-stack}
 \end{itemize}

\item Underflow read
 \begin{itemize}[noitemsep, nolistsep, leftmargin=1em]
    \item[\ref{test-underflow-read-index-rodata}]     \texttt{underflow-read-index-rodata}
    \item[\ref{test-underflow-read-index-data}]       \texttt{underflow-read-index-data}
    \item[\ref{test-underflow-read-index-heap}]       \texttt{underflow-read-index-heap}
    \item[\ref{test-underflow-read-index-stack}]      \texttt{underflow-read-index-stack}
    \item[\ref{test-underflow-read-ptr-rodata}]       \texttt{underflow-read-ptr-rodata}
    \item[\ref{test-underflow-read-ptr-data}]         \texttt{underflow-read-ptr-data}
    \item[\ref{test-underflow-read-ptr-heap}]         \texttt{underflow-read-ptr-heap}
    \item[\ref{test-underflow-read-ptr-stack}]        \texttt{underflow-read-ptr-stack}
 \end{itemize}

\item Overflow write
 \begin{itemize}[noitemsep, nolistsep, leftmargin=1em]
    \item[\ref{test-overflow-write-index-data}]       \texttt{overflow-write-index-data}
    \item[\ref{test-overflow-write-index-heap}]       \texttt{overflow-write-index-heap}
    \item[\ref{test-overflow-write-index-stack}]      \texttt{overflow-write-index-stack}
    \item[\ref{test-overflow-write-ptr-data}]         \texttt{overflow-write-ptr-data}
    \item[\ref{test-overflow-write-ptr-heap}]         \texttt{overflow-write-ptr-heap}
    \item[\ref{test-overflow-write-ptr-stack}]        \texttt{overflow-write-ptr-stack}
 \end{itemize}

\item Underflow write
 \begin{itemize}[noitemsep, nolistsep, leftmargin=1em]
    \item[\ref{test-underflow-write-index-data}]      \texttt{underflow-write-index-data}
    \item[\ref{test-underflow-write-index-heap}]      \texttt{underflow-write-index-heap}
    \item[\ref{test-underflow-write-index-stack}]     \texttt{underflow-write-index-stack}
    \item[\ref{test-underflow-write-ptr-data}]        \texttt{underflow-write-ptr-data}
    \item[\ref{test-underflow-write-ptr-heap}]        \texttt{underflow-write-ptr-heap}
    \item[\ref{test-underflow-write-ptr-stack}]       \texttt{underflow-write-ptr-stack}
 \end{itemize}

\end{itemize}

\newpage

\subsection{\texttt{overflow-read-index-rodata}}\label{test-overflow-read-index-rodata}

\subsubsection{Description}

\textbf{Overflow} by illegally using the buffer \textbf{index}.
The index exceeds the expected buffer length,
leading to ilegal \textbf{read} accesses to the data outside the buffer.
The accesses occur in the \textbf{read only data} section.

\subsubsection{Vulnerability}
Generic data access violation.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{overflow-read-index-data}}\label{test-overflow-read-index-data}

\subsubsection{Description}

\textbf{Overflow} by illegally using the buffer \textbf{index}.
The index exceeds the expected buffer length,
leading to ilegal \textbf{read} accesses to the data outside the buffer.
The accesses occur in the \textbf{data} section.

\subsubsection{Vulnerability}
Generic data access violation.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{overflow-read-index-heap}}\label{test-overflow-read-index-heap}

\subsubsection{Description}

\textbf{Overflow} by illegally using the buffer \textbf{index}.
The index exceeds the expected buffer length,
leading to ilegal \textbf{read} accesses to the data outside the buffer.
The accesses occur in the \textbf{heap} (dynamically allocated data).

\subsubsection{Vulnerability}
Generic data access violation.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{overflow-read-index-stack}}\label{test-overflow-read-index-stack}

\subsubsection{Description}

\textbf{Overflow} by illegally using the buffer \textbf{index}.
The index exceeds the expected buffer length,
leading to ilegal \textbf{read} accesses to the data outside the buffer.
The accesses occur in the \textbf{stack}.

\subsubsection{Vulnerability}
Generic data access violation.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{overflow-read-ptr-rodata}}\label{test-overflow-read-ptr-rodata}

\subsubsection{Description}

\textbf{Overflow} by illegally using the buffer \textbf{pointer}.
The pointer is modified to pointing a location outside the buffer,
leading to ilegal \textbf{read} accesses to the data outside the buffer.
The accesses occur in the \textbf{read only data} section.

\subsubsection{Vulnerability}
Generic data access violation.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{overflow-read-ptr-data}}\label{test-overflow-read-ptr-data}

\subsubsection{Description}

\textbf{Overflow} by illegally using the buffer \textbf{pointer}.
The pointer is modified to pointing a location outside the buffer,
leading to ilegal \textbf{read} accesses to the data outside the buffer.
The accesses occur in the \textbf{data} section.

\subsubsection{Vulnerability}
Generic data access violation.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{overflow-read-ptr-heap}}\label{test-overflow-read-ptr-heap}

\subsubsection{Description}

\textbf{Overflow} by illegally using the buffer \textbf{pointer}.
The pointer is modified to pointing a location outside the buffer,
leading to ilegal \textbf{read} accesses to the data outside the buffer.
The accesses occur in the \textbf{heap} (dynamically allocated data).

\subsubsection{Vulnerability}
Generic data access violation.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{overflow-read-ptr-stack}}\label{test-overflow-read-ptr-stack}

\subsubsection{Description}

\textbf{Overflow} by illegally using the buffer \textbf{pointer}.
The pointer is modified to pointing a location outside the buffer,
leading to ilegal \textbf{read} accesses to the data outside the buffer.
The accesses occur in the \textbf{stack}.

\subsubsection{Vulnerability}
Generic data access violation.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{underflow-read-index-rodata}}\label{test-underflow-read-index-rodata}

\subsubsection{Description}

\textbf{Underflow} by illegally using the buffer \textbf{index}.
The index exceeds the expected buffer length,
leading to ilegal \textbf{read} accesses to the data outside the buffer.
The accesses occur in the \textbf{read only data} section.

\subsubsection{Vulnerability}
Generic data access violation.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{underflow-read-index-data}}\label{test-underflow-read-index-data}

\subsubsection{Description}

\textbf{Underflow} by illegally using the buffer \textbf{index}.
The index exceeds the expected buffer length,
leading to ilegal \textbf{read} accesses to the data outside the buffer.
The accesses occur in the \textbf{data} section.

\subsubsection{Vulnerability}
Generic data access violation.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{underflow-read-index-heap}}\label{test-underflow-read-index-heap}

\subsubsection{Description}

\textbf{Underflow} by illegally using the buffer \textbf{index}.
The index exceeds the expected buffer length,
leading to ilegal \textbf{read} accesses to the data outside the buffer.
The accesses occur in the \textbf{heap} (dynamically allocated data).

\subsubsection{Vulnerability}
Generic data access violation.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{underflow-read-index-stack}}\label{test-underflow-read-index-stack}

\subsubsection{Description}

\textbf{Underflow} by illegally using the buffer \textbf{index}.
The index exceeds the expected buffer length,
leading to ilegal \textbf{read} accesses to the data outside the buffer.
The accesses occur in the \textbf{stack}.

\subsubsection{Vulnerability}
Generic data access violation.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{underflow-read-ptr-rodata}}\label{test-underflow-read-ptr-rodata}

\subsubsection{Description}

\textbf{Underflow} by illegally using the buffer \textbf{pointer}.
The pointer is modified to pointing a location outside the buffer,
leading to ilegal \textbf{read} accesses to the data outside the buffer.
The accesses occur in the \textbf{read only data} section.

\subsubsection{Vulnerability}
Generic data access violation.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{underflow-read-ptr-data}}\label{test-underflow-read-ptr-data}

\subsubsection{Description}

\textbf{Underflow} by illegally using the buffer \textbf{pointer}.
The pointer is modified to pointing a location outside the buffer,
leading to ilegal \textbf{read} accesses to the data outside the buffer.
The accesses occur in the \textbf{data} section.

\subsubsection{Vulnerability}
Generic data access violation.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{underflow-read-ptr-heap}}\label{test-underflow-read-ptr-heap}

\subsubsection{Description}

\textbf{Underflow} by illegally using the buffer \textbf{pointer}.
The pointer is modified to pointing a location outside the buffer,
leading to ilegal \textbf{read} accesses to the data outside the buffer.
The accesses occur in the \textbf{heap} (dynamically allocated data).

\subsubsection{Vulnerability}
Generic data access violation.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{underflow-read-ptr-stack}}\label{test-underflow-read-ptr-stack}

\subsubsection{Description}

\textbf{Underflow} by illegally using the buffer \textbf{pointer}.
The pointer is modified to pointing a location outside the buffer,
leading to ilegal \textbf{read} accesses to the data outside the buffer.
The accesses occur in the \textbf{stack}.

\subsubsection{Vulnerability}
Generic data access violation.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{overflow-write-index-data}}\label{test-overflow-write-index-data}

\subsubsection{Description}

\textbf{Overflow} by illegally using the buffer \textbf{index}.
The index exceeds the expected buffer length,
leading to ilegal \textbf{write} accesses to the data outside the buffer.
The overwrite occurs in the \textbf{data} section.

\subsubsection{Vulnerability}
Generic data overwrite and loss.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{overflow-write-index-heap}}\label{test-overflow-write-index-heap}

\subsubsection{Description}

\textbf{Overflow} by illegally using the buffer \textbf{index}.
The index exceeds the expected buffer length,
leading to ilegal \textbf{write} accesses to the data outside the buffer.
The overwrite occurs in the \textbf{heap} (dynamically allocated data).

\subsubsection{Vulnerability}
Generic data overwrite and loss.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{overflow-write-index-stack}}\label{test-overflow-write-index-stack}

\subsubsection{Description}

\textbf{Overflow} by illegally using the buffer \textbf{index}.
The index exceeds the expected buffer length,
leading to ilegal \textbf{write} accesses to the data outside the buffer.
The overwrite occurs in the \textbf{stack}.

\subsubsection{Vulnerability}
Generic data overwrite and loss.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{overflow-write-ptr-data}}\label{test-overflow-write-ptr-data}

\subsubsection{Description}

\textbf{Overflow} by illegally using a buffer \textbf{pointer}.
The pointer is modified to pointing a location outside the buffer,
leading to ilegal \textbf{write} accesses to the data outside the buffer.
The overwrite occurs in the \textbf{data} section.

\subsubsection{Vulnerability}
Generic data overwrite and loss.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{overflow-write-ptr-heap}}\label{test-overflow-write-ptr-heap}

\subsubsection{Description}

\textbf{Overflow} by illegally using a buffer \textbf{pointer}.
The pointer is modified to pointing a location outside the buffer,
leading to ilegal \textbf{write} accesses to the data outside the buffer.
The overwrite occurs in the \textbf{heap} (dynamically allocated data).

\subsubsection{Vulnerability}
Generic data overwrite and loss.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{overflow-write-ptr-stack}}\label{test-overflow-write-ptr-stack}

\subsubsection{Description}

\textbf{Overflow} by illegally using a buffer \textbf{pointer}.
The pointer is modified to pointing a location outside the buffer,
leading to ilegal \textbf{write} accesses to the data outside the buffer.
The overwrite occurs in the \textbf{stack}.

\subsubsection{Vulnerability}
Generic data overwrite and loss.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{underflow-write-index-data}}\label{test-underflow-write-index-data}

\subsubsection{Description}

\textbf{Underflow} by illegally using the buffer \textbf{index}.
The index exceeds the expected buffer length,
leading to ilegal \textbf{write} accesses to the data outside the buffer.
The overwrite occurs in the \textbf{data} section.

\subsubsection{Vulnerability}
Generic data overwrite and loss.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{underflow-write-index-heap}}\label{test-underflow-write-index-heap}

\subsubsection{Description}

\textbf{Underflow} by illegally using the buffer \textbf{index}.
The index exceeds the expected buffer length,
leading to ilegal \textbf{write} accesses to the data outside the buffer.
The overwrite occurs in the \textbf{heap} (dynamically allocated data).

\subsubsection{Vulnerability}
Generic data overwrite and loss.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{underflow-write-index-stack}}\label{test-underflow-write-index-stack}

\subsubsection{Description}

\textbf{Underflow} by illegally using the buffer \textbf{index}.
The index exceeds the expected buffer length,
leading to ilegal \textbf{write} accesses to the data outside the buffer.
The overwrite occurs in the \textbf{stack}.

\subsubsection{Vulnerability}
Generic data overwrite and loss.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{underflow-write-ptr-data}}\label{test-underflow-write-ptr-data}

\subsubsection{Description}

\textbf{Underflow} by illegally using a buffer \textbf{pointer}.
The pointer is modified to pointing a location outside the buffer,
leading to ilegal \textbf{write} accesses to the data outside the buffer.
The overwrite occurs in the \textbf{data} section.

\subsubsection{Vulnerability}
Generic data overwrite and loss.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage


\subsection{\texttt{underflow-write-ptr-heap}}\label{test-underflow-write-ptr-heap}

\subsubsection{Description}

\textbf{Underflow} by illegally using a buffer \textbf{pointer}.
The pointer is modified to pointing a location outside the buffer,
leading to ilegal \textbf{write} accesses to the data outside the buffer.
The overwrite occurs in the \textbf{heap} (dynamically allocated data).

\subsubsection{Vulnerability}
Generic data overwrite and loss.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{underflow-write-ptr-stack}}\label{test-underflow-write-ptr-stack}

\subsubsection{Description}

\textbf{Underflow} by illegally using a buffer \textbf{pointer}.
The pointer is modified to pointing a location outside the buffer,
leading to ilegal \textbf{write} accesses to the data outside the buffer.
The overwrite occurs in the \textbf{stack}.

\subsubsection{Vulnerability}
Generic data overwrite and loss.

\subsubsection{Test result}

\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

None.

\newpage

\section{Control Flow Integrity (CFI)}

\begin{itemize}[noitemsep]
\item Forward-edge CFI
  \begin{itemize}[noitemsep, nolistsep, leftmargin=1em]
  \item Call
    \begin{itemize}[noitemsep, nolistsep, leftmargin=1em]
    \item[\ref{test-call-instruction-in-data}]        \texttt{call-instruction-in-data}
    \item[\ref{test-call-instruction-in-heap}]        \texttt{call-instruction-in-heap}
    \item[\ref{test-call-instruction-in-rodata}]      \texttt{call-instruction-in-rodata}
    \item[\ref{test-call-instruction-in-stack}]       \texttt{call-instruction-in-stack}
    \item[\ref{test-call-mid-func}]                   \texttt{call-mid-func}
    \item[\ref{test-call-mid-instruction}]            \texttt{call-mid-instruction}
    \item[\ref{test-call-wrong-func-offset-vtable}]   \texttt{call-wrong-func-offset-vtable}
    \item[\ref{test-call-wrong-func-poly-vtable}]     \texttt{call-wrong-func-poly-vtable}
    \item[\ref{test-call-wrong-func-vtable}]          \texttt{call-wrong-func-vtable}
    \item[\ref{test-call-wrong-func-within-static-analysis}]  \texttt{call-wrong-func-within-static-analysis}
    \item[\ref{test-call-wrong-func}]                 \texttt{call-wrong-func}
    \item[\ref{test-call-wrong-num-arg-func}]         \texttt{call-wrong-num-arg-func}
    \item[\ref{test-call-wrong-num-arg-vtable-heap}]  \texttt{call-wrong-num-arg-vtable-heap}
    \item[\ref{test-call-wrong-num-arg-vtable}]       \texttt{call-wrong-num-arg-vtable}
    \item[\ref{test-call-wrong-num-func-vtable-heap}] \texttt{call-wrong-num-func-vtable-heap}
    \item[\ref{test-call-wrong-num-func-vtable}]      \texttt{call-wrong-num-func-vtable}
    \item[\ref{test-call-wrong-type-arg-dp2fp-func-data}] \texttt{call-wrong-type-arg-dp2fp-func-data}
    \item[\ref{test-call-wrong-type-arg-dp2fp-func-heap}] \texttt{call-call-wrong-type-arg-dp2fp-func-heap}
    \item[\ref{test-call-wrong-type-arg-dp2fp-func-rodata}]   \texttt{call-wrong-type-arg-dp2fp-func-rodata}
    \item[\ref{test-call-wrong-type-arg-dp2fp-func-stack}]    \texttt{call-wrong-type-arg-dp2fp-func-stack}
    \item[\ref{test-call-wrong-type-arg-fp2dp-func}]  \texttt{call-wrong-type-arg-fp2dp-func}
    \item[\ref{test-call-wrong-type-arg-int2double-func}] \texttt{call-wrong-type-arg-int2double-func}
    \item[\ref{test-call-wrong-type-arg-vtable-heap}] \texttt{call-wrong-type-arg-func-vtable-heap}
    \item[\ref{test-call-wrong-type-arg-vtable}]      \texttt{call-wrong-type-arg-vtable}
    \item[\ref{test-call-wrong-type-arg-func}]        \texttt{call-wrong-type-arg-func}
    \item[\ref{test-call-wrong-vtable-heap}]          \texttt{call-wrong-vtable-heap}
    \end{itemize}
  \item Jump
    \begin{itemize}[noitemsep, nolistsep, leftmargin=1em]
    \item[\ref{test-jump-instruction-in-bss}]       \texttt{jump-instruction-in-bss}
    \item[\ref{test-jump-instruction-in-heap}]      \texttt{jump-instruction-in-heap}
    \item[\ref{test-jump-instruction-in-rodata}]    \texttt{jump-instruction-in-rodata}
    \item[\ref{test-jump-instruction-in-stack}]     \texttt{jump-instruction-in-stack}
    \item[\ref{test-jump-mid-func}]                 \texttt{jump-mid-func}
    \item[\ref{test-jump-mid-instruction}]          \texttt{jump-mid-instruction}
    \end{itemize}
  \end{itemize}
\item Backward-edge CFI
  \begin{itemize}[noitemsep, nolistsep, leftmargin=1em]
  \item Return
    \begin{itemize}[noitemsep, nolistsep, leftmargin=1em]
    \item[\ref{test-return-to-func}]                  \texttt{return-to-func}
    \item[\ref{test-return-to-instruction-in-data}]   \texttt{return-to-instruction-in-data}
    \item[\ref{test-return-to-instruction-in-heap}]   \texttt{return-to-instruction-in-heap}
    \item[\ref{test-return-to-instruction-in-rodata}] \texttt{return-to-instruction-in-rodata}
    \item[\ref{test-return-to-instruction-in-stack}]  \texttt{return-to-instruction-in-stack}
    \item[\ref{test-return-to-libc}]                  \texttt{return-to-libc}
    \item[\ref{test-return-to-mid-instruction}]       \texttt{return-to-mid-instruction}
    \item[\ref{test-return-to-non-call-site}]         \texttt{return-to-non-call-site}
    \item[\ref{test-return-to-wrong-call-site}]       \texttt{return-to-wrong-call-site}
    \item[\ref{test-return-without-call}]             \texttt{return-to-without-call}
    \end{itemize}
  \end{itemize}
\end{itemize}

\newpage
\subsection{\texttt{call-instruction-in-data}}\label{test-call-instruction-in-data}

\subsubsection{Description}
Call instructions written in the \textbf{data} section.

\subsubsection{Vulnerability}
Execute code in writable memory.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  16             & \textbf{E$\oplus$W protection in place} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

\newpage

\subsection{\texttt{call-instruction-in-heap}}\label{test-call-instruction-in-heap}

\subsubsection{Description}
Call instructions written in \textbf{heap} (dynamically allocated space).

\subsubsection{Vulnerability}
Execute code in writable memory.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  16             & \textbf{E$\oplus$W protection in place} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

\newpage

\subsection{\texttt{call-instruction-in-rodata}}\label{test-call-instruction-in-rodata}

\subsubsection{Description}
Call instructions written in the \textbf{read-only rodata} section.

\subsubsection{Vulnerability}
Treat read-only data as code.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

\newpage

\subsection{\texttt{call-instruction-in-stack}}\label{test-call-instruction-in-stack}

\subsubsection{Description}
Call instructions written in the \textbf{stack}.

\subsubsection{Vulnerability}
Execute code in writable memory.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  16             & \textbf{E$\oplus$W protection in place} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

\newpage

\subsection{\texttt{call-mid-func}}\label{test-call-mid-func}

\subsubsection{Description}
\textbf{Call} a fake function entry point at the \textbf{middle} of a \textbf{function}.

\subsubsection{Vulnerability}
Illegal function entry point.

\subsubsection{Remarks}
This is a common case for calling (forward-edge) a gadget in a ROP attack.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

None.

\newpage
\subsection{\texttt{call-mid-instruction}}\label{test-call-mid-instruction}

\subsubsection{Description}
\textbf{Call} a fake instruction located at the \textbf{middle} of an other legal \textbf{instruction}.

\subsubsection{Vulnerability}
Illegal function entry point; illegal instruction formation.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & might be \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

Currently it is difficult to differentiate the case of a success call to the middle of an instruction
and the case of fixed return value through compiler optimization.


\newpage
\subsection{\texttt{call-wrong-func-offset-vtable}}\label{test-call-wrong-func-offset-vtable}

\subsubsection{Description}
Modify the \textbf{virtual table} pointer by making it pointing to its own vitual table but with a non-zero \textbf{offset}.
\textbf{Call} a \textbf{function} with the \textbf{wrong} virtual table.

\subsubsection{Vulnerability}
Modifying the virtual table pointer; modifying the virtual table pointer by adding an offset.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  1              & might be \textbf{blocked by compiler optimization} \\
  2--4           & \textbf{partially vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

None.

\newpage


\subsection{\texttt{call-wrong-func-poly-vtable}}\label{test-call-wrong-func-poly-vtable}

\subsubsection{Description}
Modify the \textbf{virtual table} pointer by making it pointing to another virtual table used by a different class derived from the same parent.
\textbf{Call} a \textbf{function} with the \textbf{wrong} virtual table.

\subsubsection{Vulnerability}
Modifying the virtual table pointer; modifying the virtual table pointer with a polymorphic one.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  1              & might be \textbf{blocked by compiler optimization} \\
  4              & \textbf{partially vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}
None.

\newpage

\subsection{\texttt{call-wrong-func-vtable}}\label{test-call-wrong-func-vtable}

\subsubsection{Description}
Modify the \textbf{virtual table} pointer by making it pointing to another unrelated virtual table.
\textbf{Call} a \textbf{function} with the \textbf{wrong} virtual table.

\subsubsection{Vulnerability}
Modifying the virtual table pointer.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  1              & might be \textbf{blocked by compiler optimization} \\
  4              & \textbf{partially vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{call-wrong-func-within-static-analysis}}\label{test-call-wrong-func-within-static-analysis}

\subsubsection{Description}
Modify a \textbf{function} pointer by pointing it to a function \textbf{within} the reachable function set by \textbf{static analysis} but unreachable at run-time.
\textbf{Call} using the modified function pointer.

\subsubsection{Vulnerability}
Modify a function pointer; coarse-grained CFI protection.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  2              & might be \textbf{blocked by compiler optimization} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

None.

\newpage

\subsection{\texttt{call-wrong-func}}\label{test-call-wrong-func}

\subsubsection{Description}
Modify a \textbf{function} pointer by pointing it to a function unreachable by a static analysis.
\textbf{Call} using the modified function pointer.

\subsubsection{Vulnerability}
Modify a function pointer.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  2              & might be \textbf{blocked by compiler optimization} \\
  1,3            & partially \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

None.

\newpage
\subsection{\texttt{call-wrong-num-arg-func}}\label{test-call-wrong-num-arg-func}

\subsubsection{Description}
Illegally call a function with mismatched number of arguements.

\subsubsection{Vulnerability}
Break the function calling convention.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}
None.

\newpage

\subsection{\texttt{call-wrong-num-arg-vtable-heap}}\label{test-call-wrong-num-arg-vtable-heap}

\subsubsection{Description}
Replace the Vtable pointer with a fake Vtable constructed in heap and
illegally call a virtual function with mismatched number of arguements.

\subsubsection{Vulnerability}
Break the function calling convention, the data integrity of the Vtable pointer and the Vtable itself.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

\textbf{x86\_64}: Currently only works with object allocated on heap.


\newpage
\subsection{\texttt{call-wrong-num-arg-vtable}}\label{test-call-wrong-num-arg-vtable}

\subsubsection{Description}
Illegally call a virtual function with mismatched number of arguements by modifying the VTable pointer.

\subsubsection{Vulnerability}
Break the function calling convention and the data integrity of the Vtable pointer.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

\textbf{x86\_64}: Currently only works with object allocated on heap.


\newpage
\subsection{\texttt{call-wrong-num-func-vtable-heap}}\label{test-call-wrong-num-func-vtable-heap}

\subsubsection{Description}
Replace the Vtable pointer with a fake Vtable constructed in heap with different number of virtual functions and
illegally call a fake virtual function.

\subsubsection{Vulnerability}
Break the data integrity of the Vtable pointer and the Vtable itself.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

\textbf{x86\_64}: Currently only works with object allocated on heap.

\newpage
\subsection{\texttt{call-wrong-num-func-vtable}}\label{test-call-wrong-num-func-vtable}

\subsubsection{Description}
Illegally call a fake virtual function with the VTable being replaced with another one of different number of virtual functions.

\subsubsection{Vulnerability}
Break the data integrity of the Vtable pointer.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

\textbf{x86\_64}: Currently only works with object allocated on heap.

\newpage
\subsection{\texttt{call-wrong-type-arg-dp2fp-func-data}}\label{test-call-wrong-type-arg-dp2fp-func-data}

\subsubsection{Description}
Illegally call a function with wrong types of arguments constructed in \textbf{data}.

\subsubsection{Vulnerability}
Break the function calling convention and non-execution on writable area (\textbf{data}).

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

\newpage
\subsection{\texttt{call-wrong-type-arg-dp2fp-func-heap}}\label{test-call-wrong-type-arg-dp2fp-func-heap}

\subsubsection{Description}
Illegally call a function with wrong types of arguments constructed in \textbf{heap}.

\subsubsection{Vulnerability}
Break the function calling convention and non-execution on writable area (\textbf{heap}).

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

\newpage
\subsection{\texttt{call-wrong-type-arg-dp2fp-func-rodata}}\label{test-call-wrong-type-arg-dp2fp-func-rodata}

\subsubsection{Description}
Illegally call a function with wrong types of arguments constructed in \textbf{rodata}.

\subsubsection{Vulnerability}
Break the function calling convention and it’s excutable on writable area (\textbf{rodata}).

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

\newpage

\subsection{\texttt{call-wrong-type-arg-dp2fp-func-stack}}\label{test-call-wrong-type-arg-dp2fp-func-stack}

\subsubsection{Description}
Illegally call a function with wrong types of arguments constructed in \textbf{stack}.

\subsubsection{Vulnerability}
Break the function calling convention and non-execution on writable area (\textbf{stack}).

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}


\newpage

\subsection{\texttt{call-wrong-type-arg-fp2dp-func}}\label{test-call-wrong-type-arg-fp2dp-func}

\subsubsection{Description}
Illegally call a function with wrong types of argument (dp)  expected to be fp.

\subsubsection{Vulnerability}
Break the function calling convention.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

\newpage
\subsection{\texttt{call-wrong-type-arg-int2double-func}}\label{test-call-wrong-type-arg-int2double-func}

\subsubsection{Description}
Illegally call a function with wrong types of argument (int) expected to be double.

\subsubsection{Vulnerability}
Break the function calling convention.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

\newpage
\subsection{\texttt{call-wrong-type-arg-vtable-heap}}\label{test-call-wrong-type-arg-vtable-heap}

\subsubsection{Description}
Replace the Vtable pointer with a fake Vtable constructed in heap and
illegally call a virtual function with wrong types of arguements.

\subsubsection{Vulnerability}
Break the function calling convention, the data integrity of the Vtable pointer and the Vtable itself.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}
\textbf{x86\_64}: Currently only works with object allocated on heap.

\newpage
\subsection{\texttt{call-wrong-type-arg-vtable}}\label{test-call-wrong-type-arg-vtable}

\subsubsection{Description}
Illegally call a function with wrong types of arguements by modifying the VTable pointer.

\subsubsection{Vulnerability}
Break the function calling convention and the data integrity of the Vtable pointer.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}
\textbf{x86\_64}: Currently only works with object allocated on heap.

\newpage

\subsection{\texttt{call-wrong-type-arg-func}}\label{test-call-wrong-type-arg-func}

\subsubsection{Description}
Illegally call a function with wrong types of arguements.

\subsubsection{Vulnerability}
Break the function calling convention.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}
None.

\newpage

\subsection{\texttt{call-wrong-vtable-heap}}\label{test-call-wrong-vtable-heap}

\subsubsection{Description}
Replace the Vtable pointer with a fake Vtable constructed in heap.

\subsubsection{Vulnerability}
Break the data integrity of the Vtable pointer and the Vtable itself.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

\textbf{x86\_64}: Currently only works with object allocated on heap.
\newpage
\subsection{\texttt{jump-instruction-in-bss}}\label{test-jump-instruction-in-bss}

\subsubsection{Description}
Illegally jump from a function to an instruction constructed in \textbf{bss}.

\subsubsection{Vulnerability}
Break the execution compartment complied by most C/C++ programs and non-execution on writable area (\textbf{bss}).

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}


\newpage
\subsection{\texttt{jump-instruction-in-heap}}\label{test-jump-instruction-in-heap}

\subsubsection{Description}
Illegally jump from a function to an instruction constructed in \textbf{heap}.

\subsubsection{Vulnerability}
Break the execution compartment complied by most C/C++ programs and non-execution on writable area (\textbf{heap}).

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}


\newpage
\subsection{\texttt{jump-instruction-in-rodata}}\label{test-jump-instruction-in-rodata}

\subsubsection{Description}
Illegally jump from a function to an instruction constructed in \textbf{rodata}.

\subsubsection{Vulnerability}
Break the execution compartment complied by most C/C++ programs and it’s excutable on writable area (\textbf{rodata}).

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

\newpage
\subsection{\texttt{jump-instruction-in-stack}}\label{test-jump-instruction-in-stack}

\subsubsection{Description}
Illegally jump from a function to an instruction constructed in \textbf{stack}.

\subsubsection{Vulnerability}
Break the execution compartment complied by most C/C++ programs and non-execution on writable area (\textbf{stack}).

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

\newpage
\subsection{\texttt{jump-mid-func}}\label{test-jump-mid-func}

\subsubsection{Description}
\textbf{Jump} to the \textbf{middle} of another \textbf{function}.

\subsubsection{Vulnerability}
Illegal jump target; breaking the function execution context.

\subsubsection{Remarks}
This is a common case for jumping to (forward-edge) a gadget in a JOP attack.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

None.

\newpage
\subsection{\texttt{jump-mid-instruction}}\label{test-jump-mid-instruction}

\subsubsection{Description}
\textbf{Jump} to a fake instruction located at the \textbf{middle} of an other legal \textbf{instruction}.

\subsubsection{Vulnerability}
Illegal instruction formation.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  3              & \textbf{partially vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

None.

\newpage
\subsection{\texttt{return-to-func}}\label{test-return-to-func}

\subsubsection{Description}
Illegally modify the return address stored on the stack and directly return to another function.

\subsubsection{Vulnerability}
Break the backward CFI and the integrity of the return address.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

\newpage
\subsection{\texttt{return-to-instruction-in-data}}\label{test-return-to-instruction-in-data}

\subsubsection{Description}
Illegally modify the return address stored on the stack and then return to  an instruction constructed in \textbf{data}.

\subsubsection{Vulnerability}
Break the backward CFI and the integrity of the return address and non-execution on writable area (\textbf{data}).

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

\newpage
\subsection{\texttt{return-to-instruction-in-heap}}\label{test-return-to-instruction-in-heap}

\subsubsection{Description}
Illegally modify the return address stored on the stack and then return to  an instruction constructed in \textbf{heap}.

\subsubsection{Vulnerability}
Break the backward CFI and the integrity of the return address and non-execution on writable area (\textbf{heap}).

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

\newpage
\subsection{\texttt{return-to-instruction-in-rodata}}\label{test-return-to-instruction-in-rodata}

\subsubsection{Description}
Illegally modify the return address stored on the stack and then return to  an instruction constructed in \textbf{rodata}.

\subsubsection{Vulnerability}
Break the backward CFI and the integrity of the return address and it’s  executable on writable area (\textbf{rodata}).

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

\newpage
\subsection{\texttt{return-to-instruction-in-stack}}\label{test-return-to-instruction-in-stack}

\subsubsection{Description}
Illegally modify the return address stored on the stack and then return to  an instruction constructed in \textbf{stack}.

\subsubsection{Vulnerability}
Break the backward CFI and the integrity of the return address and non-execution on writable area (\textbf{stack}).

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}
\newpage
\subsection{\texttt{return-to-libc}}\label{test-return-to-libc}

\subsubsection{Description}
Illegally modify the return address stored on the stack and then return to a libc.

\subsubsection{Vulnerability}
Break the backward CFI and the integrity of the return address.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

\newpage
\subsection{\texttt{return-to-mid-instruction}}\label{test-return-to-mid-instruction}

\subsubsection{Description}
Illegally modify the return address stored on the stack and then return to the middle of an instruction.

\subsubsection{Vulnerability}
Break the backward CFI and the integrity of the return address.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

\newpage
\subsection{\texttt{return-to-non-call-site}}\label{test-return-to-non-call-site}

\subsubsection{Description}
Illegally modify the return address stored on the stack and then return to an none call-site position.

\subsubsection{Vulnerability}
Break the backward CFI and the integrity of the return address.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

\textbf{x86\_64}: The \texttt{rbp} register might be (with \texttt{-g}) or not be (with \texttt{-O2}) pushed to the stack.
The return address is modified by embedded assembly using \texttt{rsp} as the base register. See \texttt{STACK\_STRUCT} in the make file.

\newpage
\subsection{\texttt{return-to-wrong-call-site}}\label{test-return-to-wrong-call-site}

\subsubsection{Description}
Illegally modify the return address stored on the stack and then return to a wrong call-site position.

\subsubsection{Vulnerability}
Break the backward CFI and the integrity of the return address.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}


\newpage

\subsection{\texttt{return-without-call}}\label{test-return-without-call}

\subsubsection{Description}
Illegally add a fake function call onto the stack and return to it..

\subsubsection{Vulnerability}
Break the backward CFI and the integrity of the return address.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}
\textbf{x86\_64}: The \texttt{rbp} register might be (with \texttt{-g}) or not be (with \texttt{-O2}) pushed to the stack.
Currently the test works only with \texttt{-O2}.

\chapter{Remaining Issues}

\begin{itemize}
  \item \texttt{call-wrong-num-arg-func} \ref{test-call-wrong-num-arg-func}: test for arguements passed on stack.
  \item \texttt{call-wrong-type-arg-func} \ref{test-call-wrong-type-arg-func}: more importantly, test (data/code) pointer to integer.
  \item \texttt{call-wrong-num-arg-vtable} \ref{test-call-wrong-num-arg-vtable}: known issues.
  \item \texttt{call-wrong-num-func-vtable} \ref{test-call-wrong-num-func-vtable}: known issues.
  \item \texttt{return-without-call} \ref{test-return-without-call}: known issues.
  \item call a unvisible function (call a local function from outside).
  \item differentiate between global data, heap and stack.
\end{itemize}

\end{document}
\grid
