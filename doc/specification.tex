\documentclass[a4paper]{book}

\usepackage{mathptmx}
\usepackage{helvet}
\usepackage{courier}
\usepackage{type1cm}
\usepackage{graphicx}
\usepackage{multicol}
\usepackage[bottom]{footmisc}
\usepackage[hyphens]{url}
\usepackage[pdftex]{hyperref}
\usepackage{color}
\usepackage{soul}
\usepackage[caption=false,font=footnotesize]{subfig}
\usepackage{amsmath}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage{cite}
\usepackage{enumitem}
\usepackage{comment}
\usepackage{listings}
\lstset{frame=tb,basicstyle={\footnotesize\ttfamily}}

\begin{document}

\title{\textbf{A Security Benchmark Suite Exploring the Existing Vulnerabilities of a Computer System} \\ \large{Version: 0.1.0}}

\author{Wei Song, Jiameng Ying and Boya Li\\
\small{Institute of Information Engineeringat at the Chinese Academy of Sciences}\\
\small{89 Minzhuang Road, Haidian, Beijing 100093, P. R. China}\\
\small{\url{{songwei, yingjiameng, liboya}@iie.ac.cn}}}

\maketitle

\copyright 2017-2018, Institute of Information Engineering, CAS, all right reserved.

\tableofcontents
\newpage

\chapter{Introduction}

\chapter{Overview of the Security Benchmark Suite}

\chapter{Description of Test Cases}

\section{Control Flow Integrity (CFI)}

\begin{itemize}[noitemsep]
\item Forward-edge CFI
  \begin{itemize}[noitemsep, nolistsep, leftmargin=1em]
  \item Call
    \begin{itemize}[noitemsep, nolistsep, leftmargin=1em]
    \item \ref{test-wrong-num-arg-func}: \texttt{wrong-num-arg-func}
    \item \ref{test-wrong-num-arg-vtable}: \texttt{wrong-num-arg-vtable}
    \item \ref{test-wrong-type-arg-func}: \texttt{wrong-type-arg-func}
    \item \ref{test-wrong-num-func-vtable}: \texttt{wrong-num-func-vtable}
    \item \ref{test-call-mid-func}: \texttt{call-mid-func}
    \end{itemize}
  \item Jump
    \begin{itemize}[noitemsep, nolistsep, leftmargin=1em]
    \item \ref{test-jump-mid-func}: \texttt{jump-mid-func}
    \end{itemize}
  \end{itemize}
\item Backward-edge CFI
  \begin{itemize}[noitemsep, nolistsep, leftmargin=1em]
  \item Return
    \begin{itemize}[noitemsep, nolistsep, leftmargin=1em]
    \item \ref{test-return-non-call-site}: \texttt{return-non-call-site}
    \item \ref{test-return-to-func}: \texttt{return-to-func}
    \item \ref{test-return-without-call}: \texttt{return-to-without-call}
    \end{itemize}
  \end{itemize}
\end{itemize}

\newpage
\subsection{\texttt{wrong-num-arg-func}}\label{test-wrong-num-arg-func}

\subsubsection{Description}
Illegally call a function with mismatched number of arguements.

\subsubsection{Vulnerability}
Break the function calling convention.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}
None.

\newpage
\subsection{\texttt{wrong-num-arg-vtable}}\label{test-wrong-num-arg-vtable}

\subsubsection{Description}
Illegally call a virtual function with mismatched number of arguements by modifying the VTable pointer.

\subsubsection{Vulnerability}
Break the data integrity of the Vtable pointer.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

\textbf{x86\_64}: Currently only works with object allocated on heap.


\newpage
\subsection{\texttt{wrong-type-arg-func}}\label{test-wrong-type-arg-func}

\subsubsection{Description}
Illegally call a function with wrong types of arguements.

\subsubsection{Vulnerability}
Break the function calling convention.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}
None.

\newpage
\subsection{\texttt{wrong-num-func-vtable}}\label{test-wrong-num-func-vtable}

\subsubsection{Description}
Illegally call a fake virtual function with the VTable being replaced with another one of different number of virtual functions.

\subsubsection{Vulnerability}
Break the data integrity of the Vtable pointer.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}

\subsubsection{Known issues}

\textbf{x86\_64}: Currently only works with object allocated on heap.

\newpage
\subsection{\texttt{call-mid-func}}\label{test-call-mid-func}

\subsubsection{Description}
Illegally call a fake function located at the middle of a function from \texttt{main()}.

\subsubsection{Vulnerability}
Illegal callee site.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

None.

\newpage
\subsection{\texttt{jump-mid-func}}\label{test-jump-mid-func}

\subsubsection{Description}
Illegally jump from the \texttt{main()} function to the middle of another function.

\subsubsection{Vulnerability}
Break the execution compartment complied by most C/C++ programs.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

None.

\newpage
\subsection{\texttt{return-non-call-site}}\label{test-return-non-call-site}

\subsubsection{Description}
Illegally modify the return address stored on the stack and then return to an none call-site position.

\subsubsection{Vulnerability}
Break the backward CFI and the integrity of the return address.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

\textbf{x86\_64}: The \texttt{rbp} register might be (with \texttt{-g}) or not be (with \texttt{-O2}) pushed to the stack.
The return address is modified by embedded assembly using \texttt{rsp} as the base register. See \texttt{STACK\_STRUCT} in the make file.

\newpage
\subsection{\texttt{return-to-func}}\label{test-return-to-func}

\subsubsection{Description}
Illegally modify the return address stored on the stack and directly return to another function.

\subsubsection{Vulnerability}
Break the backward CFI and the integrity of the return address.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}

\newpage
\subsection{\texttt{return-without-call}}\label{test-return-without-call}

\subsubsection{Description}
Illegally add a fake function call onto the stack and return to it..

\subsubsection{Vulnerability}
Break the backward CFI and the integrity of the return address.

\subsubsection{Test result}
\begin{tabular}{cl}
  \toprule
  \emph{return}  & \emph{description} \\
  \midrule
  0              & \textbf{vulnerable} \\
  other          & might be safe \\
  \bottomrule
\end{tabular}
  
\subsubsection{Known issues}
\textbf{x86\_64}: The \texttt{rbp} register might be (with \texttt{-g}) or not be (with \texttt{-O2}) pushed to the stack.
Currently the test works only with \texttt{-O2}.

\chapter{Remaining Issues}

\begin{itemize}
  \item \texttt{wrong-num-arg-func} \ref{test-wrong-num-arg-func}: test for arguements passed on stack.
  \item \texttt{wrong-type-arg-func} \ref{test-wrong-type-arg-func}: more importantly, test (data/code) pointer to integer.
  \item \texttt{wrong-num-arg-vtable} \ref{test-wrong-num-arg-vtable}: known issues.
  \item \texttt{wrong-num-func-vtable} \ref{test-wrong-num-func-vtable}: known issues.
  \item \texttt{return-without-call} \ref{test-return-without-call}: known issues.
  \item call a unvisible function (call a local function from outside).
  \item differentiate between global data, heap and stack.
\end{itemize}

\end{document}
